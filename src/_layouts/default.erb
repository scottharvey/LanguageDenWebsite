<!doctype html>
<html lang="<%= site.locale %>">
  <head>
    <%= render "head", metadata: site.metadata, title: data.title %>
    <script>
      // Theme init â€” runs before paint to prevent FOUC
      (function () {
        var stored = localStorage.getItem('theme');
        var prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        var theme = stored || (prefersDark ? 'dark' : 'light');
        document.documentElement.setAttribute('data-theme', theme);
      })();
    </script>
    <script>
      !function(t,e){var o,n,p,r;e.__SV||(window.posthog && window.posthog.__loaded)||(window.posthog=e,e._i=[],e.init=function(i,s,a){function g(t,e){var o=e.split(".");2==o.length&&(t=t[o[0]],e=o[1]),t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}}(p=t.createElement("script")).type="text/javascript",p.crossOrigin="anonymous",p.async=!0,p.src=s.api_host.replace(".i.posthog.com","-assets.i.posthog.com")+"/static/array.js",(r=t.getElementsByTagName("script")[0]).parentNode.insertBefore(p,r);var u=e;for(void 0!==a?u=e[a]=[]:a="posthog",u.people=u.people||[],u.toString=function(t){var e="posthog";return"posthog"!==a&&(e+="."+a),t||(e+=" (stub)"),e},u.people.toString=function(){return u.toString(1)+".people (stub)"},o="init ls vs Ce hs cs ns us capture calculateEventProperties gs register register_once register_for_session unregister unregister_for_session xs getFeatureFlag getFeatureFlagPayload getFeatureFlagResult isFeatureEnabled reloadFeatureFlags updateFlags updateEarlyAccessFeatureEnrollment getEarlyAccessFeatures on onFeatureFlags onSurveysLoaded onSessionId getSurveys getActiveMatchingSurveys renderSurvey displaySurvey cancelPendingSurvey canRenderSurvey canRenderSurveyAsync identify setPersonProperties group resetGroups setPersonPropertiesForFlags resetPersonPropertiesForFlags setGroupPropertiesForFlags resetGroupPropertiesForFlags reset get_distinct_id getGroups get_session_id get_session_replay_url alias set_config startSessionRecording stopSessionRecording sessionRecordingStarted captureException startExceptionAutocapture stopExceptionAutocapture loadToolbar get_property getSessionProperty ys createPersonProfile setInternalOrTestUser ws rs $s opt_in_capturing opt_out_capturing has_opted_in_capturing has_opted_out_capturing get_explicit_consent_status is_capturing clear_opt_in_out_capturing fs debug M bs getPageViewId captureTraceFeedback captureTraceMetric Zr".split(" "),n=0;n<o.length;n++)g(u,o[n]);e._i.push([i,s,a])},e.__SV=1)}(document,window.posthog||[]);
      posthog.init('phc_2woLU7EsHkYzHsIfEXBB8TRVGqUXfnTnaT490vu1Aou', {
        api_host: 'https://us.i.posthog.com',
        defaults: '2026-01-30',
        person_profiles: 'identified_only',
      })
    </script>
  </head>
  <body class="<%= data.layout %> <%= data.page_class %>">
    <header class="site-header" id="site-header">
      <nav class="nav-container">
        <a href="<%= relative_url '/' %>" class="nav-logo">
          <img src="<%= relative_url '/images/app-icon.png' %>" alt="" class="nav-logo-icon" width="28" height="28" aria-hidden="true">
          <span class="logo-text">Language Den</span>
        </a>
        <button class="nav-toggle" id="nav-toggle" aria-label="Toggle navigation" aria-expanded="false" aria-controls="nav-links">
          <svg class="nav-toggle-icon nav-toggle-icon--open" width="20" height="20" viewBox="0 0 20 20" fill="none" aria-hidden="true">
            <path d="M3 5h14M3 10h14M3 15h14" stroke="currentColor" stroke-width="1.75" stroke-linecap="round"/>
          </svg>
          <svg class="nav-toggle-icon nav-toggle-icon--close" width="20" height="20" viewBox="0 0 20 20" fill="none" aria-hidden="true">
            <path d="M4 4l12 12M16 4L4 16" stroke="currentColor" stroke-width="1.75" stroke-linecap="round"/>
          </svg>
        </button>
        <ul class="nav-links" id="nav-links">
          <li><a href="<%= relative_url '/docs' %>">Docs</a></li>
          <li><a href="<%= relative_url '/privacy' %>">Privacy</a></li>
          <li><a href="<%= relative_url '/support' %>">Support</a></li>
          <li>
            <button class="theme-toggle" id="theme-toggle" aria-label="Toggle dark mode">
              <svg class="theme-icon theme-icon--sun" width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <circle cx="12" cy="12" r="4" stroke="currentColor" stroke-width="2"/>
                <path d="M12 2v2M12 20v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M2 12h2M20 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
              <svg class="theme-icon theme-icon--moon" width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
          </li>
          <% if site.metadata.app_store_url && !site.metadata.app_store_url.empty? %>
          <li><a href="<%= site.metadata.app_store_url %>" class="nav-cta">Download</a></li>
          <% end %>
        </ul>
      </nav>
    </header>
    <script>
      (function () {
        // Theme toggle
        var themeToggle = document.getElementById('theme-toggle');
        if (themeToggle) {
          themeToggle.addEventListener('click', function () {
            var current = document.documentElement.getAttribute('data-theme');
            var next = current === 'dark' ? 'light' : 'dark';
            document.documentElement.setAttribute('data-theme', next);
            localStorage.setItem('theme', next);
          });
        }

        var toggle = document.getElementById('nav-toggle');
        var header = document.getElementById('site-header');
        var links = document.getElementById('nav-links');
        if (!toggle || !header) return;

        function openMenu() {
          header.classList.add('nav-open');
          toggle.setAttribute('aria-expanded', 'true');
        }
        function closeMenu() {
          header.classList.remove('nav-open');
          toggle.setAttribute('aria-expanded', 'false');
        }

        toggle.addEventListener('click', function (e) {
          e.stopPropagation();
          header.classList.contains('nav-open') ? closeMenu() : openMenu();
        });

        // Close when a nav link is clicked
        if (links) {
          links.querySelectorAll('a').forEach(function (a) {
            a.addEventListener('click', closeMenu);
          });
        }

        // Close on outside click
        document.addEventListener('click', function (e) {
          if (!header.contains(e.target)) closeMenu();
        });

        // Close on Escape
        document.addEventListener('keydown', function (e) {
          if (e.key === 'Escape') closeMenu();
        });
      })();
    </script>

    <%= yield %>

    <footer class="site-footer">
      <div class="footer-container">
        <div class="footer-brand">
          <span class="logo-text">Language Den</span>
        </div>
        <nav class="footer-links">
          <a href="<%= relative_url '/docs' %>">Documentation</a>
          <a href="<%= relative_url '/privacy' %>">Privacy Policy</a>
          <a href="<%= relative_url '/support' %>">Support</a>
          <a href="mailto:<%= site.metadata.email %>"><%= site.metadata.email %></a>
        </nav>
        <p class="footer-copy">&copy; <%= Time.now.year %> Language Den. All rights reserved.</p>
      </div>
    </footer>
  </body>
</html>
